<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ­ ê³µë™ ì†Œê°ì¥ â€” ì°¨ë¡€ë¡œ íƒœìš°ê¸°</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700;800&family=Noto+Sans+KR:wght@300;400;600&display=swap');

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:        #0b0c0f;
  --panel:     #13151c;
  --border:    rgba(255,255,255,0.07);
  --fire-white:#f0ece4;
  --amber:     #ffb84d;
  --ember:     #ff5500;
  --gain:      #8fe0aa;
  --gain-glow: rgba(130,210,160,0.5);
  --queue-bg:  #0f1118;
  --card-idle: #1a1d27;
  --card-next: #232840;
}

html, body {
  height: 100%;
  background: var(--bg);
  color: var(--fire-white);
  font-family: 'Noto Sans KR', sans-serif;
  overflow-x: hidden;
}

body {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 32px 16px 60px;
}

/* ë°°ê²½ ë¶ˆë¹› */
.bg-glow {
  position: fixed; bottom: 0; left: 50%;
  transform: translateX(-50%);
  width: 900px; height: 300px;
  background: radial-gradient(ellipse at bottom, rgba(255,55,0,0.08) 0%, transparent 68%);
  pointer-events: none; z-index: 0;
}

/* â”€â”€ í—¤ë” â”€â”€ */
header {
  text-align: center; z-index: 1;
  margin-bottom: 24px;
}
.eyebrow {
  font-size: 0.65rem; letter-spacing: 0.38em;
  color: rgba(255,140,60,0.45); text-transform: uppercase;
  margin-bottom: 7px;
}
h1 {
  font-family: 'Nanum Myeongjo', serif; font-weight: 800;
  font-size: 1.85rem; color: #e6e0d6;
  letter-spacing: 0.04em; margin-bottom: 5px;
  text-shadow: 0 0 40px rgba(255,100,0,0.18);
}
.tagline {
  font-size: 0.75rem; color: rgba(200,195,185,0.33);
  letter-spacing: 0.16em;
}

/* â”€â”€ ë©”ì¸ 3ì—´ ë ˆì´ì•„ì›ƒ â”€â”€ */
.arena {
  display: flex;
  align-items: flex-start;
  gap: 20px;
  z-index: 1;
  width: 100%;
  max-width: 860px;
}

/* â”€â”€ ì™¼ìª½: ì…ë ¥ + ëŒ€ê¸° ë”ë¯¸ â”€â”€ */
.left-col {
  display: flex;
  flex-direction: column;
  gap: 14px;
  width: 220px;
  flex-shrink: 0;
}

.section-label {
  font-size: 0.6rem; letter-spacing: 0.28em;
  text-transform: uppercase; color: rgba(200,195,185,0.28);
  margin-bottom: 2px;
}

/* ì…ë ¥ íŒ¨ë„ */
.input-panel {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 14px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
input[type="text"] {
  width: 100%;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: var(--fire-white);
  font-family: 'Noto Sans KR', sans-serif;
  font-size: 0.88rem;
  padding: 10px 12px;
  outline: none;
  transition: border-color 0.3s, box-shadow 0.3s;
}
input::placeholder { color: rgba(200,190,170,0.22); font-size: 0.82rem; }
input:focus {
  border-color: rgba(255,100,0,0.4);
  box-shadow: 0 0 12px rgba(255,70,0,0.1);
}
input:disabled { opacity: 0.4; cursor: not-allowed; }

.btn-add {
  width: 100%;
  background: var(--card-idle);
  border: 1px solid rgba(255,100,0,0.28);
  border-radius: 6px;
  color: rgba(255,170,70,0.85);
  cursor: pointer;
  font-family: 'Nanum Myeongjo', serif; font-weight: 700;
  font-size: 0.9rem; letter-spacing: 0.14em;
  padding: 10px;
  transition: all 0.2s;
}
.btn-add:not(:disabled):hover {
  background: linear-gradient(135deg, #b83200, #d45500);
  color: #fff; border-color: transparent;
}
.btn-add:disabled { opacity: 0.38; cursor: not-allowed; }

/* ëŒ€ê¸° ë”ë¯¸ */
.queue-panel {
  background: var(--queue-bg);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px;
  min-height: 220px;
  max-height: 480px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 0;
  position: relative;
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.08) transparent;
}
.queue-panel::-webkit-scrollbar { width: 4px; }
.queue-panel::-webkit-scrollbar-track { background: transparent; }
.queue-panel::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.08);
  border-radius: 4px;
}

.queue-empty {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.72rem; color: rgba(200,195,185,0.18);
  letter-spacing: 0.1em; text-align: center;
  padding: 20px;
  pointer-events: none;
}

/* ëŒ€ê¸° ì¹´ë“œ */
.q-card {
  background: var(--card-idle);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 6px;
  padding: 8px 12px;
  font-family: 'Nanum Myeongjo', serif;
  font-size: 0.85rem;
  color: rgba(240,236,228,0.75);
  position: relative;
  overflow: hidden;
  transition: transform 0.3s, opacity 0.3s, box-shadow 0.3s;
  margin-bottom: 6px;
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
}
.q-card.next {
  background: var(--card-next);
  border-color: rgba(255,100,0,0.3);
  box-shadow: 0 0 14px rgba(255,80,0,0.12);
  color: rgba(240,236,228,0.95);
}
.q-card.next::before {
  content: '';
  position: absolute; left: 0; top: 0; bottom: 0;
  width: 3px;
  background: linear-gradient(to bottom, #ff6600, #ff3300);
  border-radius: 6px 0 0 6px;
}
.q-num {
  font-size: 0.6rem; color: rgba(200,195,185,0.28);
  flex-shrink: 0; min-width: 14px;
}
.q-card.next .q-num { color: rgba(255,140,60,0.5); }
.q-text {
  flex: 1; min-width: 0;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* ëŒ€ê¸° ì§„í–‰ í‘œì‹œ */
.queue-status {
  font-size: 0.65rem; color: rgba(200,195,185,0.25);
  text-align: center; margin-top: 2px;
  letter-spacing: 0.08em;
}
.queue-status.active { color: rgba(255,140,60,0.45); }

/* â”€â”€ ì¤‘ì•™: ì†Œê°ì¥ â”€â”€ */
.center-col {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  min-width: 0;
}

/* í˜„ì¬ ì†Œê° ì¤‘ì¸ ë‹¨ì–´ í‘œì‹œ */
.now-burning {
  width: 100%;
  min-height: 48px;
  background: rgba(255,80,0,0.05);
  border: 1px solid rgba(255,80,0,0.12);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  gap: 10px;
  margin-bottom: 12px;
  padding: 10px 16px;
  opacity: 0;
  transition: opacity 0.4s;
}
.now-burning.visible { opacity: 1; }
.now-label {
  font-size: 0.6rem; letter-spacing: 0.2em;
  color: rgba(255,120,60,0.45); text-transform: uppercase;
  flex-shrink: 0;
}
.now-word {
  font-family: 'Nanum Myeongjo', serif; font-weight: 700;
  font-size: 1rem; color: rgba(255,200,120,0.85);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

.furnace-wrap {
  width: 100%;
  max-width: 300px;
  aspect-ratio: 1;
  position: relative; flex-shrink: 0;
}
.furnace-svg {
  width: 100%; height: 100%;
  filter: drop-shadow(0 0 14px rgba(255,80,0,0.25));
  transition: filter 0.5s;
}

/* â”€â”€ ì˜¤ë¥¸ìª½: ê²°ê³¼ í”¼ë“œ â”€â”€ */
.right-col {
  width: 200px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding-top: 2px;
}

.feed-list {
  display: flex;
  flex-direction: column;
  gap: 7px;
  max-height: 480px;
  overflow-y: auto;
  padding-right: 4px;
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,0.08) transparent;
}
.feed-list::-webkit-scrollbar {
  width: 4px;
}
.feed-list::-webkit-scrollbar-track {
  background: transparent;
}
.feed-list::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.08);
  border-radius: 4px;
}

.feed-item {
  background: rgba(255,255,255,0.025);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 10px 13px;
  animation: feedIn 0.45s cubic-bezier(0.34,1.56,0.64,1);
}
@keyframes feedIn {
  from { opacity:0; transform:translateX(16px) scale(0.95); }
  to   { opacity:1; transform:translateX(0) scale(1); }
}
.fi-burned {
  font-family: 'Nanum Myeongjo', serif;
  font-size: 0.78rem;
  color: rgba(160,155,145,0.42);
  text-decoration: line-through;
  text-decoration-color: rgba(255,80,0,0.3);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  margin-bottom: 4px;
}
.fi-gain {
  font-family: 'Nanum Myeongjo', serif; font-weight: 700;
  font-size: 0.86rem;
  color: var(--gain);
  text-shadow: 0 0 10px var(--gain-glow);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.fi-arrow {
  font-size: 0.65rem; color: rgba(200,195,185,0.18);
  margin: 0 3px;
}

/* ì†Œê°ì¥ ì²˜ë¦¬ ì¤‘ ì»¤ì„œ */
.processing-indicator {
  display: flex; align-items: center; gap: 6px;
  font-size: 0.68rem; color: rgba(255,140,60,0.4);
  letter-spacing: 0.1em; margin-top: 10px; justify-content: center;
  min-height: 18px;
}
.proc-dot {
  width: 5px; height: 5px; border-radius: 50%;
  background: rgba(255,140,60,0.5);
  animation: procPulse 1s ease-in-out infinite;
}
.proc-dot:nth-child(2) { animation-delay: 0.2s; }
.proc-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes procPulse {
  0%,100% { opacity:0.3; transform:scale(0.7); }
  50%     { opacity:1;   transform:scale(1.2); }
}

/* â”€â”€ íŒŒí‹°í´ â”€â”€ */
#particle-container {
  position: fixed; inset: 0;
  pointer-events: none; z-index: 500;
}
.spark {
  position: absolute; border-radius: 50%;
  animation: sparkFly var(--dur,1s) ease-out forwards;
}
@keyframes sparkFly {
  0%   { opacity:1; transform:translate(0,0) scale(1); }
  100% { opacity:0; transform:translate(var(--tx),var(--ty)) scale(0.05); }
}
.smoke-p {
  position: absolute; border-radius: 50%;
  background: radial-gradient(circle, rgba(120,120,120,0.38), transparent);
  animation: smokeDrift var(--dur,2s) ease-out forwards;
}
@keyframes smokeDrift {
  0%   { opacity:0.5;  transform:translate(0,0) scale(0.4); }
  100% { opacity:0;    transform:translate(var(--tx),var(--ty)) scale(2); }
}
.g-spark {
  position: absolute;
  animation: gSparkFly var(--dur,1.4s) ease-out forwards;
  font-size: var(--sz,12px); color: var(--gain);
}
@keyframes gSparkFly {
  0%   { opacity:1; transform:translate(0,0) scale(1) rotate(0deg); }
  100% { opacity:0; transform:translate(var(--tx),var(--ty)) scale(0.1) rotate(270deg); }
}

/* ë‚ ì•„ê°€ëŠ” ë‹¨ì–´ */
.flying-word {
  position: fixed;
  font-family: 'Nanum Myeongjo', serif; font-weight: 700;
  font-size: 1.1rem; color: #f0ddb0;
  pointer-events: none; z-index: 600;
  white-space: nowrap; max-width: 200px;
  overflow: hidden; text-overflow: ellipsis;
}
.chimney-word {
  position: fixed;
  font-family: 'Nanum Myeongjo', serif; font-weight: 700;
  font-size: 1rem; color: var(--gain);
  pointer-events: none; z-index: 600;
  white-space: nowrap;
  text-shadow: 0 0 14px var(--gain-glow);
}

/* SVG ì• ë‹ˆë©”ì´ì…˜ */
@keyframes cSmoke {
  0%   { opacity:0.5;  transform:translateY(0) scaleX(1); }
  50%  { opacity:0.28; transform:translateY(-14px) scaleX(1.2); }
  100% { opacity:0;    transform:translateY(-28px) scaleX(1.5); }
}
.cs1 { animation:cSmoke 2.3s ease-out infinite; }
.cs2 { animation:cSmoke 2.7s ease-out infinite 0.75s; }
.cs3 { animation:cSmoke 1.9s ease-out infinite 1.5s; }
@keyframes fd {
  0%,100%{ transform:scaleY(1)    scaleX(1); }
  33%    { transform:scaleY(1.12) scaleX(0.9); }
  66%    { transform:scaleY(0.92) scaleX(1.08); }
}
.fa1 { animation:fd 1.4s ease-in-out infinite;      transform-origin:center bottom; }
.fa2 { animation:fd 1.8s ease-in-out infinite 0.4s; transform-origin:center bottom; }
.fa3 { animation:fd 1.1s ease-in-out infinite 0.9s; transform-origin:center bottom; }
@keyframes gp { 0%,100%{opacity:.58}50%{opacity:1} }
.gp  { animation:gp 1.6s ease-in-out infinite; }
@keyframes wb { 0%,100%{opacity:.25}50%{opacity:1} }
.wl1 { animation:wb 1.1s ease-in-out infinite; }
.wl2 { animation:wb 1.1s ease-in-out infinite 0.55s; }

/* ì¹´ë“œ ì†Œê°ì¥ìœ¼ë¡œ ë‚ ì•„ê°€ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
.q-card.flying-out {
  transition: transform 0.8s cubic-bezier(0.55,0,1,0.45), opacity 0.6s ease;
}

/* ë°˜ì‘í˜• */
@media (max-width: 700px) {
  .arena { flex-direction: column; align-items: center; }
  .left-col, .right-col { width: 100%; max-width: 320px; }
  .right-col { order: 3; }
}
</style>
</head>
<body>
<div class="bg-glow"></div>

<header>
  <p class="eyebrow">ë§ˆìŒì˜ ì†Œê°ì¥</p>
  <h1>ì°¨ë¡€ë¡œ íƒœìš°ê¸°</h1>
  <p class="tagline">ìŒ“ì¸ ê²ƒë“¤ì„ í•˜ë‚˜ì”© ë‚´ë ¤ë†“ìŠµë‹ˆë‹¤</p>
</header>

<div class="arena">

  <!-- â”€â”€ ì™¼ìª½: ì…ë ¥ + ëŒ€ê¸°ì—´ â”€â”€ -->
  <div class="left-col">
    <div>
      <p class="section-label">íˆ¬ì… ì ‘ìˆ˜</p>
      <div class="input-panel">
        <input type="text" id="wordInput"
               placeholder="ë²„ë¦¬ê³  ì‹¶ì€ ê²ƒ ì…ë ¥"
               maxlength="25" autocomplete="off"/>
        <button class="btn-add" id="addBtn" onclick="addToQueue()">+ ëŒ€ê¸°ì—´ì— ì¶”ê°€</button>
      </div>
    </div>

    <div>
      <p class="section-label">ëŒ€ê¸° ì¤‘ <span id="queueCount" style="color:rgba(255,140,60,0.5)">0</span>ê±´</p>
      <div class="queue-panel" id="queuePanel">
        <div class="queue-empty" id="queueEmpty">ì•„ì§ íˆ¬ì…ëœ í•­ëª©ì´<br>ì—†ìŠµë‹ˆë‹¤</div>
      </div>
      <p class="queue-status" id="queueStatus"></p>
    </div>
  </div>

  <!-- â”€â”€ ì¤‘ì•™: ì†Œê°ì¥ â”€â”€ -->
  <div class="center-col">
    <div class="now-burning" id="nowBurning">
      <span class="now-label">ì†Œê° ì¤‘</span>
      <span class="now-word" id="nowWord"></span>
    </div>

    <div class="furnace-wrap" id="furnaceWrap">
      <svg class="furnace-svg" viewBox="0 0 340 340" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <radialGradient id="dg" cx="50%" cy="60%" r="50%">
            <stop offset="0%"   stop-color="#ffe080" stop-opacity="0.9"/>
            <stop offset="40%"  stop-color="#ff6600" stop-opacity="0.75"/>
            <stop offset="100%" stop-color="#ff1a00" stop-opacity="0"/>
          </radialGradient>
          <radialGradient id="if2" cx="50%" cy="70%" r="55%">
            <stop offset="0%"   stop-color="#ffee80" stop-opacity="1"/>
            <stop offset="50%"  stop-color="#ff6600" stop-opacity="0.85"/>
            <stop offset="100%" stop-color="#1a0800" stop-opacity="1"/>
          </radialGradient>
          <linearGradient id="bld" x1="0" y1="0" x2="1" y2="0">
            <stop offset="0%"   stop-color="#1c1e26"/>
            <stop offset="50%"  stop-color="#21242d"/>
            <stop offset="100%" stop-color="#1a1c24"/>
          </linearGradient>
          <linearGradient id="rf" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%"   stop-color="#2c2f3e"/>
            <stop offset="100%" stop-color="#1e2028"/>
          </linearGradient>
          <filter id="b3"><feGaussianBlur stdDeviation="3"/></filter>
          <filter id="b5"><feGaussianBlur stdDeviation="5"/></filter>
        </defs>
        <ellipse cx="170" cy="320" rx="125" ry="9" fill="rgba(0,0,0,0.45)" filter="url(#b5)"/>
        <rect x="63" y="52" width="25" height="178" fill="#191b23" stroke="#2b2e3c" stroke-width="1.5"/>
        <rect x="63" y="52" width="25" height="7"   fill="#242730"/>
        <rect x="63" y="102" width="25" height="3.5" fill="#cc2200" opacity="0.75"/>
        <rect x="63" y="152" width="25" height="3.5" fill="#cc2200" opacity="0.75"/>
        <rect x="63" y="202" width="25" height="3.5" fill="#cc2200" opacity="0.75"/>
        <rect x="252" y="72" width="23" height="158" fill="#191b23" stroke="#2b2e3c" stroke-width="1.5"/>
        <rect x="252" y="72" width="23" height="7"   fill="#242730"/>
        <rect x="252" y="117" width="23" height="3.5" fill="#cc2200" opacity="0.75"/>
        <rect x="252" y="162" width="23" height="3.5" fill="#cc2200" opacity="0.75"/>
        <rect x="252" y="207" width="23" height="3.5" fill="#cc2200" opacity="0.75"/>
        <ellipse cx="75"  cy="44" rx="9"   ry="13" fill="#4e4e4e" class="cs1" filter="url(#b3)"/>
        <ellipse cx="72"  cy="33" rx="7"   ry="10" fill="#5e5e5e" class="cs2" filter="url(#b3)"/>
        <ellipse cx="78"  cy="24" rx="5.5" ry="8"  fill="#3e3e3e" class="cs3" filter="url(#b3)"/>
        <ellipse cx="263" cy="64" rx="8"   ry="11" fill="#484848" class="cs2" filter="url(#b3)"/>
        <ellipse cx="260" cy="54" rx="6"   ry="8.5" fill="#585858" class="cs3" filter="url(#b3)"/>
        <polygon points="88,145 170,108 252,145" fill="url(#rf)" stroke="#2b2e3c" stroke-width="1.5"/>
        <line x1="88" y1="145" x2="252" y2="145" stroke="#363a4e" stroke-width="2"/>
        <rect x="88" y="145" width="164" height="158" fill="url(#bld)" stroke="#282b38" stroke-width="1.5"/>
        <line x1="88"  y1="178" x2="252" y2="178" stroke="#1c1e26" stroke-width="1.5"/>
        <line x1="88"  y1="210" x2="252" y2="210" stroke="#1c1e26" stroke-width="1.5"/>
        <line x1="88"  y1="252" x2="252" y2="252" stroke="#1c1e26" stroke-width="1.5"/>
        <line x1="88"  y1="276" x2="252" y2="276" stroke="#1c1e26" stroke-width="1.5"/>
        <line x1="170" y1="145" x2="170" y2="303" stroke="#1c1e26" stroke-width="1"/>
        <rect x="128" y="188" width="84" height="80" rx="3" fill="#101218" stroke="#363a4e" stroke-width="2.5"/>
        <rect x="133" y="193" width="74" height="70" rx="2" fill="url(#if2)" class="gp"/>
        <rect x="133" y="193" width="74" height="70" rx="2" fill="url(#dg)" opacity="0.45" filter="url(#b3)"/>
        <g class="fa1" style="transform-origin:155px 263px"><ellipse cx="152" cy="248" rx="10" ry="18" fill="#ff5e00" opacity="0.72" filter="url(#b3)"/></g>
        <g class="fa2" style="transform-origin:170px 263px"><ellipse cx="170" cy="241" rx="8"  ry="15" fill="#ffcc00" opacity="0.78" filter="url(#b3)"/></g>
        <g class="fa3" style="transform-origin:185px 263px"><ellipse cx="184" cy="249" rx="9"  ry="16" fill="#ff8800" opacity="0.66" filter="url(#b3)"/></g>
        <rect x="128" y="188" width="84" height="9"  rx="2" fill="#282b38" stroke="#363a4e" stroke-width="1"/>
        <rect x="161" y="226" width="18" height="6"  rx="3" fill="#363a4e" stroke="#464a5e" stroke-width="1"/>
        <circle cx="110" cy="170" r="5.5" fill="#ee2200" class="wl1" filter="url(#b3)"/>
        <circle cx="110" cy="170" r="3"   fill="#ff5533" class="wl1"/>
        <circle cx="230" cy="170" r="5.5" fill="#ff8800" class="wl2" filter="url(#b3)"/>
        <circle cx="230" cy="170" r="3"   fill="#ffaa33" class="wl2"/>
        <rect x="100" y="218" width="24" height="22" rx="2" fill="#0e0f15" stroke="#282b38" stroke-width="1.5"/>
        <line x1="112" y1="218" x2="112" y2="240" stroke="#282b38" stroke-width="1"/>
        <line x1="100" y1="229" x2="124" y2="229" stroke="#282b38" stroke-width="1"/>
        <rect x="216" y="218" width="24" height="22" rx="2" fill="#0e0f15" stroke="#282b38" stroke-width="1.5"/>
        <line x1="228" y1="218" x2="228" y2="240" stroke="#282b38" stroke-width="1"/>
        <line x1="216" y1="229" x2="240" y2="229" stroke="#282b38" stroke-width="1"/>
        <rect x="116" y="268" width="108" height="8" rx="2" fill="#1e2028" stroke="#363a4e" stroke-width="1"/>
        <rect x="123" y="274" width="15" height="5" rx="2" fill="#282b38"/>
        <rect x="152" y="274" width="15" height="5" rx="2" fill="#282b38"/>
        <rect x="181" y="274" width="15" height="5" rx="2" fill="#282b38"/>
        <rect x="83"  y="300" width="174" height="13" rx="2" fill="#16181f" stroke="#282b38" stroke-width="1"/>
        <rect x="150" y="118" width="20" height="11" rx="2" fill="#242730" stroke="#363a4e" stroke-width="1"/>
        <rect x="155" y="114" width="10" height="5"  rx="1" fill="#1e2028"/>
      </svg>
    </div>

    <div class="processing-indicator" id="procIndicator" style="display:none">
      <div class="proc-dot"></div>
      <div class="proc-dot"></div>
      <div class="proc-dot"></div>
      <span>ì†Œê° ì²˜ë¦¬ ì¤‘</span>
    </div>
  </div>

  <!-- â”€â”€ ì˜¤ë¥¸ìª½: ê²°ê³¼ í”¼ë“œ â”€â”€ -->
  <div class="right-col">
    <p class="section-label">ì†Œê° ê²°ê³¼</p>
    <div class="feed-list" id="feedList">
      <div style="font-size:0.7rem;color:rgba(200,195,185,0.18);text-align:center;padding:20px 0;letter-spacing:0.08em">
        ì•„ì§ ì†Œê°ëœ í•­ëª©ì´<br>ì—†ìŠµë‹ˆë‹¤
      </div>
    </div>
  </div>

</div><!-- /arena -->

<div id="particle-container"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ìƒíƒœ ê´€ë¦¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const queue       = [];      // { word, cardEl }
let   isProcessing = false;

const queuePanel   = document.getElementById('queuePanel');
const queueEmpty   = document.getElementById('queueEmpty');
const queueCountEl = document.getElementById('queueCount');
const queueStatus  = document.getElementById('queueStatus');
const nowBurning   = document.getElementById('nowBurning');
const nowWordEl    = document.getElementById('nowWord');
const procIndicator= document.getElementById('procIndicator');
const furnaceWrap  = document.getElementById('furnaceWrap');
const feedList     = document.getElementById('feedList');
const particleCon  = document.getElementById('particle-container');
const wordInput    = document.getElementById('wordInput');

wordInput.addEventListener('keydown', e => { if (e.key === 'Enter') addToQueue(); });

/* â”€â”€ ëŒ€ê¸°ì—´ ì¶”ê°€ â”€â”€ */
function addToQueue() {
  const word = wordInput.value.trim();
  if (!word) {
    wordInput.style.borderColor = '#ff2200';
    setTimeout(() => wordInput.style.borderColor = 'rgba(255,255,255,0.1)', 600);
    return;
  }
  wordInput.value = '';
  wordInput.focus();

  // ë¹ˆ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
  queueEmpty.style.display = 'none';

  // ì¹´ë“œ ìƒì„±
  const idx    = queue.length + 1;
  const cardEl = document.createElement('div');
  cardEl.className = 'q-card';
  if (queue.length === 0 && !isProcessing) cardEl.classList.add('next');
  cardEl.innerHTML = `<span class="q-num">${idx}</span><span class="q-text">${esc(word)}</span>`;

  // ì…ì¥ ì• ë‹ˆë©”ì´ì…˜
  cardEl.style.opacity = '0';
  cardEl.style.transform = 'translateX(-16px)';
  queuePanel.appendChild(cardEl);
  requestAnimationFrame(() => {
    cardEl.style.transition = 'opacity 0.35s ease, transform 0.35s cubic-bezier(0.34,1.56,0.64,1)';
    cardEl.style.opacity = '1';
    cardEl.style.transform = 'translateX(0)';
  });

  queue.push({ word, cardEl });
  updateQueueUI();
  // ìƒˆ ì¹´ë“œê°€ ë³´ì´ë„ë¡ ëŒ€ê¸°ì—´ ë§¨ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤
  requestAnimationFrame(() => { queuePanel.scrollTop = queuePanel.scrollHeight; });

  // ì²˜ë¦¬ ì¤‘ì´ ì•„ë‹ˆë©´ ìë™ ì‹œì‘
  if (!isProcessing) processNext();
}

/* â”€â”€ í UI ê°±ì‹  â”€â”€ */
function updateQueueUI() {
  queueCountEl.textContent = queue.length;

  if (queue.length === 0) {
    queueEmpty.style.display = 'flex';
  }

  // ì²« ë²ˆì§¸ ì¹´ë“œì— next ê°•ì¡°
  queue.forEach((item, i) => {
    if (i === 0 && !isProcessing) {
      item.cardEl.classList.add('next');
    } else {
      item.cardEl.classList.remove('next');
    }
    // ë²ˆí˜¸ ê°±ì‹ 
    const numEl = item.cardEl.querySelector('.q-num');
    if (numEl) numEl.textContent = i + 1;
  });

  if (queue.length > 0) {
    queueStatus.className = 'queue-status';
    queueStatus.textContent = `${queue.length}ê±´ ëŒ€ê¸° ì¤‘`;
  } else if (isProcessing) {
    queueStatus.className = 'queue-status active';
    queueStatus.textContent = 'ì†Œê° ì²˜ë¦¬ ì¤‘...';
  } else {
    queueStatus.className = 'queue-status';
    queueStatus.textContent = '';
  }
}

/* â”€â”€ ìˆœì°¨ ì²˜ë¦¬ â”€â”€ */
async function processNext() {
  if (queue.length === 0) {
    isProcessing = false;
    nowBurning.classList.remove('visible');
    procIndicator.style.display = 'none';
    updateQueueUI();
    return;
  }

  isProcessing = true;
  procIndicator.style.display = 'flex';

  const item   = queue[0];
  const { word, cardEl } = item;

  // "ì†Œê° ì¤‘" í‘œì‹œ
  nowWordEl.textContent = word;
  nowBurning.classList.add('visible');

  // ì¹´ë“œ next ê°•ì¡°
  cardEl.classList.add('next');
  updateQueueUI();

  // ì ê¹ ëŒ€ê¸° (ì‚¬ëŒë“¤ì´ ë³¼ ìˆ˜ ìˆê²Œ)
  await sleep(700);

  // ì¹´ë“œ â†’ ì†Œê°ì¥ìœ¼ë¡œ ë‚ ì•„ê°€ê¸°
  await flyCardToFurnace(cardEl, word);

  // ëŒ€ê¸°ì—´ì—ì„œ ì œê±°
  queue.shift();
  updateQueueUI();

  // íŒŒí‹°í´
  const mouthPos = getFurnaceMouthPos();
  explodeSparks(mouthPos.x, mouthPos.y, 20);
  explodeSmoke(mouthPos.x, mouthPos.y);
  flashFurnace();

  // API í˜¸ì¶œ
  let gainText = '';
  try { gainText = await fetchGain(word); }
  catch(e) { gainText = 'ìƒˆë¡œìš´ ê°€ëŠ¥ì„±'; }

  // êµ´ëš ê¸ì • ë‹¨ì–´
  const cp = getChimneyPos();
  spawnGreenSparks(cp.x, cp.y);
  await floatChimneyWord(gainText, cp.x, cp.y);

  // ê²°ê³¼ í”¼ë“œ
  addFeedItem(word, gainText);

  // ë‹¤ìŒ í•­ëª© ì²˜ë¦¬ (ì§§ì€ ëŒ€ê¸°)
  await sleep(500);
  await processNext();
}

/* â”€â”€ ì¹´ë“œê°€ ì†Œê°ì¥ íˆ¬ì…êµ¬ë¡œ ë‚ ì•„ê°€ëŠ” ì• ë‹ˆë©”ì´ì…˜ â”€â”€ */
function flyCardToFurnace(cardEl, word) {
  return new Promise(resolve => {
    const cardRect  = cardEl.getBoundingClientRect();
    const mouth     = getFurnaceMouthPos();
    const sx        = cardRect.left + cardRect.width  / 2;
    const sy        = cardRect.top  + cardRect.height / 2;

    // ì¹´ë“œë¥¼ ìˆ¨ê¸°ê³  ë‚ ì•„ê°€ëŠ” ë³µì‚¬ë³¸ ìƒì„±
    cardEl.style.opacity = '0.15';
    cardEl.style.transform = 'scale(0.85)';

    const flyEl = document.createElement('div');
    flyEl.className = 'flying-word';
    flyEl.textContent = word;
    flyEl.style.cssText = `left:${sx}px;top:${sy}px;transform:translate(-50%,-50%)`;
    document.body.appendChild(flyEl);

    const dur = 1600, t0 = performance.now();

    function frame(now) {
      const t  = Math.min((now - t0) / dur, 1);
      const mt = Math.min(t / 0.6, 1);
      // easeInQuad: ì²˜ìŒì—” ì²œì²œíˆ, ë‚˜ì¤‘ì—” ì­‰ ë¹¨ë ¤ë“¤ì–´ê°
      const ease = mt < 0.5 ? 2*mt*mt : 1 - Math.pow(-2*mt+2,2)/2;

      const cx  = sx + (mouth.x - sx) * ease;
      const cy  = sy + (mouth.y - sy) * ease;

      // t>0.5 ë¶€í„° ì¤„ì–´ë“¤ê³  ë¹¨ê°œì§€ë©° íë¦¿í•´ì§
      const shrink  = t > 0.48 ? 1 - ((t-0.48)/0.52)*0.96 : 1;
      const opacity = t > 0.44 ? Math.max(0, 1 - ((t-0.44)/0.56)) : 1;
      const g       = Math.max(0, Math.round(200*(1-t*1.4)));
      const blur    = t > 0.6  ? ((t-0.6)/0.4)*14 : 0;

      flyEl.style.left      = cx + 'px';
      flyEl.style.top       = cy + 'px';
      flyEl.style.transform = `translate(-50%,-50%) scale(${shrink})`;
      flyEl.style.opacity   = opacity;
      flyEl.style.color     = `rgb(255,${g},0)`;
      flyEl.style.filter    = `blur(${blur.toFixed(1)}px)`;

      if (t < 1) {
        requestAnimationFrame(frame);
      } else {
        flyEl.remove();
        cardEl.remove();
        resolve();
      }
    }
    requestAnimationFrame(frame);
  });
}

/* â”€â”€ êµ´ëš ë‹¨ì–´ í”¼ì–´ì˜¤ë¦„ â”€â”€ */
function floatChimneyWord(text, cx, cy) {
  return new Promise(resolve => {
    const el = document.createElement('div');
    el.className = 'chimney-word';
    el.textContent = text;
    el.style.cssText = `left:${cx}px;top:${cy}px;transform:translate(-50%,0);opacity:0`;
    document.body.appendChild(el);

    const dur=2200, rise=120, t0=performance.now();
    function frame(now) {
      const t  = Math.min((now-t0)/dur, 1);
      const op = t<0.22 ? t/0.22 : t<0.68 ? 1 : 1-((t-0.68)/0.32);
      const rE = 1 - Math.pow(1-t, 2);
      const sc = 0.42 + 0.65*(t<0.26 ? t/0.26 : 1);
      const wb = Math.sin(t*Math.PI*4) * 3;
      el.style.top       = (cy - rise*rE) + 'px';
      el.style.left      = (cx + wb) + 'px';
      el.style.opacity   = Math.max(0, op);
      el.style.transform = `translate(-50%,0) scale(${sc})`;
      if (t<1) requestAnimationFrame(frame);
      else { el.remove(); resolve(); }
    }
    requestAnimationFrame(frame);
  });
}

/* â”€â”€ ê²°ê³¼ í”¼ë“œ ì¶”ê°€ â”€â”€ */
function addFeedItem(burned, gain) {
  // ë¹ˆ ìƒíƒœ ë©”ì‹œì§€ ì œê±°
  const emptyEl = feedList.querySelector('[style*="ì•„ì§"]');
  if (emptyEl) emptyEl.remove();

  const el = document.createElement('div');
  el.className = 'feed-item';
  el.innerHTML = `
    <div class="fi-burned">${esc(burned)}</div>
    <div class="fi-gain">âœ¨ ${esc(gain)}</div>`;
  feedList.insertBefore(el, feedList.firstChild);
  feedList.scrollTop = 0;
  // ì œí•œ ì—†ìŒ â€” ë¬´ì œí•œ ëˆ„ì 
}

/* â”€â”€ ìœ„ì¹˜ ê³„ì‚° â”€â”€ */
function getFurnaceMouthPos() {
  const r = furnaceWrap.getBoundingClientRect();
  return { x: r.left + r.width*(170/340), y: r.top + r.height*(228/340) };
}
function getChimneyPos() {
  const r = furnaceWrap.getBoundingClientRect();
  return { x: r.left + r.width*(75/340),  y: r.top + r.height*(50/340) };
}

/* â”€â”€ Claude API â”€â”€ */
async function fetchGain(word) {
  const res = await fetch('https://api.anthropic.com/v1/messages', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      model: 'claude-sonnet-4-20250514',
      max_tokens: 80,
      system: `ë‹¹ì‹ ì€ ì‹¬ë¦¬ì  ì „í™˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
ì‚¬ìš©ìê°€ "ì†Œê°(ë²„ë¦¬ê³  ì‹¶ì€ ê²ƒ)"ì„ ì…ë ¥í•˜ë©´,
ê·¸ê²ƒì„ ë‚´ë ¤ë†“ì•˜ì„ ë•Œ ë¹„ë¡œì†Œ ì–»ê²Œ ë˜ëŠ” ê²ƒì„ ê°„ê²°í•œ ëª…ì‚¬í˜• ë¬¸êµ¬(5~10ì) í•˜ë‚˜ë§Œ ë‹µí•©ë‹ˆë‹¤.

ê·œì¹™:
- ë‹¨ìˆœ ë°˜ëŒ€ë§Â·ë°˜ì˜ì–´ ì ˆëŒ€ ê¸ˆì§€
- ì‰¼í‘œë¡œ ë‚˜ì—´ ê¸ˆì§€ â€” í•˜ë‚˜ì˜ ë¬¸êµ¬ë§Œ
- 'ë²„ë¦¼'ìœ¼ë¡œì¨ ì—´ë¦¬ëŠ” ì‹¬ë¦¬ì Â·ê´€ê³„ì Â·ì„±ì¥ ê³µê°„ì„ í•˜ë‚˜ì˜ í•µì‹¬ ë¬¸êµ¬ë¡œ í¬ì°©
- ëª…ì‚¬í˜• ë˜ëŠ” ëª…ì‚¬êµ¬ë¡œ ë§ˆë¬´ë¦¬

ì˜ˆì‹œ:
ì…ë ¥: ë‚´ ê²½í—˜ê³¼ ë¹„êµí•˜ëŠ” í”¼ë“œë°± â†’ ìƒˆë¡œìš´ ê´€ì ì„ ì—¬ëŠ” ëˆˆ
ì…ë ¥: ì™„ë²½í•´ì•¼ í•œë‹¤ëŠ” ê°•ë°• â†’ ì‹œë„í•  ìš©ê¸°
ì…ë ¥: ì¸ì •ë°›ê³  ì‹¶ì€ ìš•êµ¬ â†’ ë‚´ë©´ì˜ ëª©ì†Œë¦¬
ì…ë ¥: ì‹¤íŒ¨ì— ëŒ€í•œ ë‘ë ¤ì›€ â†’ ë‹¤ì‹œ ì‹œì‘í•  í˜
ì…ë ¥: í†µì œí•˜ë ¤ëŠ” ìŠµê´€ â†’ ì‹ ë¢°ì˜ ê³µê°„

ì‘ë‹µì€ ì¶œë ¥ ë¬¸êµ¬ë§Œ. ì„¤ëª… ì—†ì´.`,
      messages: [{ role: 'user', content: word }]
    })
  });
  const data = await res.json();
  return data.content?.map(c => c.text||'').join('').trim() || 'ìƒˆë¡œìš´ ê°€ëŠ¥ì„±';
}

/* â”€â”€ íŒŒí‹°í´ â”€â”€ */
function explodeSparks(cx, cy, cnt) {
  const cols = ['#ff6600','#ff3300','#ffcc00','#ff9900','#ffee44'];
  for (let i=0; i<cnt; i++) {
    const s   = document.createElement('div');
    s.className = 'spark';
    const sz  = Math.random()*6+2.5;
    const col = cols[Math.floor(Math.random()*cols.length)];
    s.style.cssText = `width:${sz}px;height:${sz}px;background:${col};left:${cx}px;top:${cy}px;transform:translate(-50%,-50%);border-radius:50%;box-shadow:0 0 ${sz*2}px ${col}`;
    const ang = Math.random()*Math.PI*2, d = Math.random()*110+25;
    s.style.setProperty('--tx', (Math.cos(ang)*d)+'px');
    s.style.setProperty('--ty', (Math.sin(ang)*d - Math.random()*50)+'px');
    const dur = (Math.random()*0.7+0.65).toFixed(2);
    s.style.setProperty('--dur', dur+'s');
    particleCon.appendChild(s);
    setTimeout(() => s.remove(), parseFloat(dur)*1000+100);
  }
}
function explodeSmoke(cx, cy) {
  for (let i=0; i<7; i++) {
    const s  = document.createElement('div');
    s.className = 'smoke-p';
    const sz = Math.random()*25+16;
    s.style.cssText = `width:${sz}px;height:${sz}px;left:${cx}px;top:${cy}px;transform:translate(-50%,-50%)`;
    s.style.setProperty('--tx', ((Math.random()-0.5)*75)+'px');
    s.style.setProperty('--ty', (-(Math.random()*80+25))+'px');
    const dur = (Math.random()*1.1+1.4).toFixed(2);
    s.style.setProperty('--dur', dur+'s');
    particleCon.appendChild(s);
    setTimeout(() => s.remove(), parseFloat(dur)*1000+100);
  }
}
function spawnGreenSparks(cx, cy) {
  const sym = ['âœ¦','âœ§','âœ¿','â—ˆ','â‹','âœº','â—‡'];
  for (let i=0; i<12; i++) {
    const s = document.createElement('div');
    s.className = 'g-spark';
    s.textContent = sym[Math.floor(Math.random()*sym.length)];
    const sz = Math.random()*8+8;
    s.style.cssText = `left:${cx}px;top:${cy}px;transform:translate(-50%,-50%)`;
    s.style.setProperty('--sz', sz+'px');
    const ang = Math.random()*Math.PI*2, d = Math.random()*80+28;
    s.style.setProperty('--tx', (Math.cos(ang)*d)+'px');
    s.style.setProperty('--ty', (Math.sin(ang)*d - 42)+'px');
    const dur = (Math.random()*0.8+1.1).toFixed(2);
    s.style.setProperty('--dur', dur+'s');
    particleCon.appendChild(s);
    setTimeout(() => s.remove(), parseFloat(dur)*1000+100);
  }
}
function flashFurnace() {
  const svg = furnaceWrap.querySelector('.furnace-svg');
  svg.style.filter = 'drop-shadow(0 0 50px rgba(255,200,0,0.85)) brightness(1.6)';
  setTimeout(() => { svg.style.filter = ''; }, 420);
}

function esc(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}
function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
</script>
</body>
</html>
